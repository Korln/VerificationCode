@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>验证码测试</title>
    <link href="~/css/site.css" rel="stylesheet" />
    <style>
        body {
            height: 100%;
            background: #16a085;
            overflow: hidden;
        }

        canvas {
            z-index: -1;
            position: absolute;
        }

        * {
            padding: 0;
            margin: 0;
        }

        #box {
            position: relative;
            width: 300px;
            height: 40px;
            margin: 0 auto;
            margin-top: 10px;
            background-color: #e8e8e8;
            box-shadow: 1px 1px 5px rgba(0,0,0,0.2);
        }

        .bgColor {
            position: absolute;
            left: 0;
            top: 0;
            width: 40px;
            height: 40px;
            background-color: lightblue;
        }

        .txt {
            position: absolute;
            width: 100%;
            height: 40px;
            line-height: 40px;
            font-size: 14px;
            color: #000;
            text-align: center;
        }

        .slider {
            position: absolute;
            left: 0;
            top: 0;
            width: 50px;
            height: 38px;
            border: 1px solid #ccc;
            background: #fff;
            text-align: center;
            cursor: move;
        }

            .slider > i {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%,-50%);
            }

            .slider.active > i {
                color: green;
            }
    </style>
    <script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-3.3.1.min.js"
            asp-fallback-src="~/lib/jquery/dist/jquery.min.js"
            asp-fallback-test="window.jQuery"
            crossorigin="anonymous"
            integrity="sha384-tsQFqpEReu7ZLhBV2VZlAu7zcOV+rXbYlF2cqB8txI/8aZajjp4Bqd+V6D5IgvKT">
    </script>
    <script src="~/js/site.js"></script>
</head>
<body>
    <dl class="admin_login">
        <dt>
            <strong></strong>
            <em></em>
        </dt>
        <dd class="user_icon">
            <input type="text" id="userName" placeholder="账号" class="login_txtbx" />
        </dd>
        <dd class="pwd_icon">
            <input type="password" id="passWord" placeholder="密码" class="login_txtbx" />
        </dd>
        <dd>
            <input type="text" name="TestCode" placeholder="请输入验证码" class="login_txtbx" style="width:50%" />  <img src="#" alt="看不清？点击更换" id="testCode" onclick="getTextCodeImage()" />
        </dd>
        <dd class="val_icon" id="VerificationCode">
        </dd>
        <dd>
            <input type="button" value="立即登陆" class="submit_btn" />
        </dd>
        <dd>
        </dd>
    </dl>

    <script type="text/javascript">
        function getTextCodeImage() {
                $.ajax({
                    url: "@Url.Action("GetCodeImage")",
                    type: "get",
                    success: function (data) {
                        $("#testCode").attr("src", data);
                    }
                })
         }
        $(document).ready(function () {
            var checkCode = [];
            var checkCount = 2;
            var num = 1;
            getTextCodeImage();
            function test(arr) {
                debugger;

             }

            $.Slider({
                getCodeUrl:'/VerificationCodeImage',
                checkCodeUrl:'/CheckVerificationCode',
                containerSelector:"#VerificationCode",
                successCallback: test
            });

            $(".submit_btn").click(function () {
                if (checkCode.length == 0) {
                    alert('请输入验证码');
                    return false;
                }
                $.ajax({
                    "url": "/Home/Login",
                    "type": "post",
                    "data": {
                        "userName": $("#userName").val(),
                        "passWord": $("#passWord").val(),
                        "Code": JSON.stringify({ CodeList: checkCode })
                    },
                    "success": function (d) {
                        alert(d.msg);
                    }
                })
            })

        });
    </script>
</body>
</html>

